<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Resources | DIWY Financial Planning</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Curated educational and planning resources by DIWY Financial Planning.">
  <meta name="keywords" content="financial resources, planning tools, advice-only, DIWY, CFP, budgeting, insurance, estate">
  <meta name="author" content="DIWY Financial Planning">

  <!-- GA4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S34LTCGWNF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-S34LTCGWNF');
  </script>

  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    :root {
      --diwy-blue: #19215A;
      --diwy-dark: #0f143c;
    }
    .bg-diwy { background-color: var(--diwy-blue); }
    .hover\:bg-diwy-dark:hover { background-color: var(--diwy-dark); }
    .text-diwy { color: var(--diwy-blue); }
    html { scroll-behavior: smooth; scroll-padding-top: 8rem; }
  </style>
</head>

<body class="bg-gray-50 text-gray-800 pt-24 md:pt-32">

  <!-- Header -->
  <header class="bg-white shadow py-4 px-6 fixed top-0 left-0 right-0 z-50">
    <div class="max-w-7xl mx-auto flex items-center justify-between">
      <a href="index.html">
        <img src="LogoDIWY20250324MO.png" alt="DIWY Financial Planning Logo" class="h-20">
      </a>
      <nav class="hidden md:flex items-center space-x-6 text-base">
        <a href="index.html" class="text-gray-700 hover:text-diwy" onclick="gtag('event', 'nav_click', { 'label': 'Home' })">Home</a>
        <a href="about.html" class="text-gray-700 hover:text-diwy" onclick="gtag('event', 'nav_click', { 'label': 'About' })">About</a>
        <a href="services.html" class="text-gray-700 hover:text-diwy" onclick="gtag('event', 'nav_click', { 'label': 'Services' })">Services</a>
        <a href="resources.html" class="text-gray-700 hover:text-diwy font-bold" onclick="gtag('event', 'nav_click', { 'label': 'Resources' })">Resources</a>
        <a href="faqs.html" class="text-gray-700 hover:text-diwy" onclick="gtag('event', 'nav_click', { 'label': 'FAQs' })">FAQs</a>
        <a href="https://app.rightcapital.com/account/login?cobrand=j-zbuBEsfc3p-GhP428gMg&type=client" target="_blank" rel="noopener noreferrer" class="text-gray-700 hover:text-diwy" onclick="gtag('event', 'nav_click', { 'label': 'Client Portal' })">Client Portal</a>
        <a href="https://app.precisefp.com/w/raabzv" target="_blank" rel="noopener noreferrer" class="ml-4 bg-diwy text-white px-4 py-2 rounded-md shadow hover:bg-diwy-dark text-sm font-medium" onclick="gtag('event', 'nav_click', { 'label': 'Schedule Intro Call' })">Schedule a Free Intro Call</a>
      </nav>
    </div>
  </header>

  <main class="pt-24 px-6 max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold text-diwy text-center mb-6">Curated Resources</h1>

    <div class="bg-yellow-100 border-l-4 border-yellow-400 p-4 mb-6 rounded">
      <p class="text-sm text-gray-800">
        <strong>Disclaimer:</strong> These links are provided for educational purposes. DIWY Financial Planning does not control third-party content and is not responsible for its accuracy. You are leaving our website when you click.
      </p>
    </div>

    <div class="mb-6 text-sm text-gray-700">
      <p>
        <strong>Have a suggestion?</strong> If a link is broken or outdated, email us at 
        <a id="emailLink" href="#" class="text-blue-700 underline hover:text-diwy">[email protected]</a>.
      </p>
    </div>

    <div class="mb-6">
      <label for="resourceSearch" class="block text-diwy font-semibold mb-2">Search Resources</label>
      <input type="text" id="resourceSearch" placeholder="Type a keyword (e.g. insurance, investing, 529)..." class="w-full px-4 py-2 border border-gray-300 rounded shadow-sm focus:outline-none focus:ring focus:ring-blue-200">
    </div>

    <button id="toggleAll" class="mb-6 px-4 py-2 bg-diwy text-white rounded hover:bg-diwy-dark">
      Expand All
    </button>

    <div id="accordionContainer"></div>
  </main>

  <footer class="bg-white border-t border-gray-200 py-8 px-6 md:px-12 text-sm text-gray-600 text-center">
    <p>&copy; <script>document.write(new Date().getFullYear())</script> DIWY Financial Planning. All rights reserved.</p>
  </footer>

  <!-- Scripts -->
  <script>
    const fallbackResources = [
      {
        category: "Consumer & Family Information",
        items: [
          ["annualcreditreport.com", "https://www.annualcreditreport.com", "free credit reports"],
          ["bankrate.com", "https://www.bankrate.com", "financial data and rates"],
          ["fiparent.com", "https://www.fiparent.com", "raise financially savvy kids"],
          ["moneytracker.com", "https://www.moneytracker.com", "budgeting help"]
        ]
      }
    ];

    function renderResources(data, keyword = '') {
      const container = document.getElementById('accordionContainer');
      container.innerHTML = '';
      const regex = keyword ? new RegExp(`(${keyword})`, 'gi') : null;

      data.forEach(section => {
        const items = section.items.filter(item =>
          !keyword || item.join(' ').toLowerCase().includes(keyword.toLowerCase())
        );
        if (!items.length) return;

        const sec = document.createElement('section');
        sec.classList.add('mb-6');
        sec.innerHTML = `
          <h2 class="text-xl font-semibold text-diwy flex justify-between items-center cursor-pointer" onclick="toggleSection(this)">
            ${section.category}
            <span class="text-lg">+</span>
          </h2>
          <ul class="accordion-content list-disc list-inside space-y-1 mt-2 hidden">
            ${items.map(([name, url, desc]) => {
              const n = regex ? name.replace(regex, '<mark>$1</mark>') : name;
              const d = regex ? desc.replace(regex, '<mark>$1</mark>') : desc;
              return `<li><a href="${url}" target="_blank" class="text-blue-700 hover:underline" onclick="gtag('event', 'outbound_click', { event_label: '${url}' })">${n}</a> – ${d}</li>`;
            }).join('')}
          </ul>`;
        container.appendChild(sec);
      });
    }

    function toggleSection(header) {
      const ul = header.nextElementSibling;
      const symbol = header.querySelector('span');
      const hidden = ul.classList.toggle('hidden');
      symbol.textContent = hidden ? '+' : '−';
    }

    document.getElementById('toggleAll').addEventListener('click', () => {
      const sections = document.querySelectorAll('#accordionContainer section');
      const expanding = toggleAll.textContent.includes('Expand');
      sections.forEach(section => {
        const ul = section.querySelector('.accordion-content');
        const symbol = section.querySelector('span');
        if (expanding) {
          ul.classList.remove('hidden');
          symbol.textContent = '−';
        } else {
          ul.classList.add('hidden');
          symbol.textContent = '+';
        }
      });
      toggleAll.textContent = expanding ? 'Collapse All' : 'Expand All';
    });

    document.getElementById('resourceSearch').addEventListener('input', function () {
      const keyword = this.value.trim();
      renderResources(window._resourceData || fallbackResources, keyword);
    });

    fetch("https://script.google.com/macros/s/AKfycbwTTAuxRfchBrjPU-QGkOA-ichOtfxYriB0H4QVwVb3xgRfk_bjl8a6rZDT-8ysZJQ6Jw/exec?sheet=resources")
      .then(r => r.json())
      .then(data => {
        window._resourceData = data;
        renderResources(data);
      })
      .catch(() => renderResources(fallbackResources));

    document.addEventListener("DOMContentLoaded", () => {
      const user = "feedback";
      const domain = "diwyfp.com";
      const email = `${user}@${domain}`;
      const link = document.getElementById("emailLink");
      if (link) {
        link.textContent = email;
        link.href = `mailto:${email}`;
      }
    });

    // GA: Time on page
    [30, 60, 120].forEach(seconds => {
      setTimeout(() => {
        gtag('event', 'time_on_page', {
          label: `${seconds}_seconds`,
          value: seconds
        });
      }, seconds * 1000);
    });

    // GA: Scroll depth
    const scrollThresholds = [25, 50, 75, 100];
    let scrollReached = {};
    window.addEventListener('scroll', () => {
      const scrollTop = window.scrollY;
      const docHeight = document.body.scrollHeight - window.innerHeight;
      const scrollPercent = (scrollTop / docHeight) * 100;
      scrollThresholds.forEach(threshold => {
        if (scrollPercent >= threshold && !scrollReached[threshold]) {
          scrollReached[threshold] = true;
          gtag('event', 'scroll_depth', {
            event_category: 'Scroll',
            event_label: `${threshold}%`
          });
        }
      });
    });
  </script>
</body>
</html>
