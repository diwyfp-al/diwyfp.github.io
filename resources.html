<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Resources | DIWY Financial Planning</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Curated financial planning resources from DIWY Financial Planning.">
  <meta name="keywords" content="financial planning resources, investing, insurance, budgeting, college savings, DIWY">
  <meta name="author" content="DIWY Financial Planning">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <!-- Google Analytics 4 -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S34LTCGWNF"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-S34LTCGWNF');
  </script>

  <script>
    function trackDIWYEvent(eventName, params = {}) {
      if (typeof gtag === 'function') {
        gtag('event', eventName, params);
      }
    }
  </script>

  <style>
    :root {
      --diwy-blue: #19215A;
      --highlight-yellow: #fff59d;
    }
    .text-diwy { color: var(--diwy-blue); }
    .bg-diwy { background-color: var(--diwy-blue); }
    .accordion-content { transition: max-height 0.3s ease; }
    mark { background-color: var(--highlight-yellow); padding: 0 2px; }
  </style>
</head>
<body class="bg-gray-50 text-gray-800 leading-relaxed">
  <!-- Header -->
  <header role="banner" class="bg-white shadow py-4 px-6 fixed top-0 left-0 right-0 z-50">
    <div class="max-w-7xl mx-auto flex items-center justify-between">
      <a href="index.html" class="flex items-center space-x-4">
        <img src="LogoDIWY20250324MO.png" alt="DIWY Financial Planning Logo" class="h-16">
      </a>
      <nav role="navigation" class="hidden md:flex items-center space-x-6 text-base">
        <a href="index.html" class="text-gray-700 hover:text-diwy" onclick="trackDIWYEvent('nav_click', { label: 'Home' })">Home</a>
        <a href="about.html" class="text-gray-700 hover:text-diwy" onclick="trackDIWYEvent('nav_click', { label: 'About' })">About</a>
        <a href="services.html" class="text-gray-700 hover:text-diwy" onclick="trackDIWYEvent('nav_click', { label: 'Services' })">Services</a>
        <a href="are_we_a_fit.html" class="text-gray-700 hover:text-diwy" onclick="trackDIWYEvent('nav_click', { label: 'Are We a Fit' })">Are We a Fit</a>
        <a href="resources.html" class="text-diwy font-semibold" onclick="trackDIWYEvent('nav_click', { label: 'Resources' })">Resources</a>
        <a href="faq.html" class="text-gray-700 hover:text-diwy" onclick="trackDIWYEvent('nav_click', { label: 'FAQ' })">FAQ</a>
        <a href="contact.html" class="bg-diwy text-white px-4 py-2 rounded hover:bg-blue-900" onclick="trackDIWYEvent('nav_click', { label: 'Schedule Intro Call' })">Schedule a Free Intro Call</a>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <main class="pt-32 px-6 max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold text-diwy mb-6">Curated Resources</h1>

    <!-- Disclaimer -->
    <div class="bg-yellow-100 border-l-4 border-yellow-400 p-4 mb-6 rounded">
      <p class="text-sm text-gray-800">
        <strong>Disclaimer:</strong> The links on this page are provided for educational and informational purposes only. Information is believed to be accurate at the time of posting but is not regularly monitored for changes. DIWY Financial Planning does not control or guarantee the accuracy, relevance, timeliness, or completeness of content on external websites. By clicking a link, users acknowledge they are leaving the DIWY Financial Planning website and accept responsibility for interacting with third-party content.
      </p>
    </div>

    <!-- Feedback Section -->
    <div class="mb-6 text-sm text-gray-700">
      <p>
        <strong>Have a suggestion?</strong> If a link appears to be broken, a resource seems outdated, or there is a recommendation for an addition or removal, please email 
        <a id="emailLink" href="#" class="text-blue-700 underline hover:text-diwy">[email protected]</a>.
      </p>
    </div>

    <!-- Search Input -->
    <div class="mb-6">
      <label for="resourceSearch" class="block text-diwy font-semibold mb-2">Search Resources</label>
      <input type="text" id="resourceSearch" placeholder="Type a keyword (e.g. insurance, investing, 529)..." class="w-full px-4 py-2 border border-gray-300 rounded shadow-sm focus:outline-none focus:ring focus:ring-blue-200">
    </div>

    <!-- Collapse Button -->
    <button id="toggleAll" class="mb-6 px-4 py-2 bg-diwy text-white rounded hover:bg-blue-900">
      Collapse All
    </button>

    <!-- Accordion Container -->
    <div id="accordionContainer">
      <!-- Sections will be dynamically inserted here -->
    </div>
  </main>

  <!-- Scripts -->
  <script>
    const fallbackResources = [
      {
        category: "Consumer & Family Information",
        items: [
          ["annualcreditreport.com", "https://www.annualcreditreport.com", "free credit reports"],
          ["bankrate.com", "https://www.bankrate.com", "financial data and rates"],
          ["fiparent.com", "https://www.fiparent.com", "raise financially savvy kids"],
          ["moneytracker.com", "https://www.moneytracker.com", "budgeting help"]
        ]
      }
    ];

    function renderResources(data, keyword = '') {
      const accordionContainer = document.getElementById('accordionContainer');
      accordionContainer.innerHTML = '';
      const regex = keyword ? new RegExp(`(${keyword})`, 'gi') : null;

      data.forEach(section => {
        const filteredItems = section.items.filter(item =>
          !keyword || item.join(' ').toLowerCase().includes(keyword.toLowerCase())
        );

        if (filteredItems.length === 0) return;

        const sec = document.createElement('section');
        sec.classList.add('mb-6');
        sec.innerHTML = `
          <h2 class="text-xl font-semibold text-diwy flex justify-between items-center cursor-pointer" onclick="toggleSection(this)">
            ${section.category}
            <span class="text-lg">−</span>
          </h2>
          <ul class="accordion-content list-disc list-inside space-y-1 mt-2">
            ${filteredItems.map(item => {
              const [name, url, desc] = item;
              const highlightedName = regex ? name.replace(regex, '<mark>$1</mark>') : name;
              const highlightedDesc = regex ? desc.replace(regex, '<mark>$1</mark>') : desc;
              return `<li>
                <a href="${url}" target="_blank" class="text-blue-700 hover:underline"
                   onclick="trackDIWYEvent('resource_click', { label: '${name}' })">
                   ${highlightedName}</a> – ${highlightedDesc}
              </li>`;
            }).join('')}
          </ul>
        `;
        accordionContainer.appendChild(sec);
      });
    }

    function toggleSection(header) {
      const ul = header.nextElementSibling;
      const symbol = header.querySelector('span');
      const expanded = ul.classList.toggle('hidden');
      symbol.textContent = expanded ? '+' : '−';
    }

    document.getElementById('toggleAll').addEventListener('click', () => {
      const sections = document.querySelectorAll('#accordionContainer section');
      const isCollapsing = toggleAll.textContent.includes('Collapse');
      sections.forEach(section => {
        const ul = section.querySelector('.accordion-content');
        const symbol = section.querySelector('span');
        if (isCollapsing) {
          ul.classList.add('hidden');
          symbol.textContent = '+';
        } else {
          ul.classList.remove('hidden');
          symbol.textContent = '−';
        }
      });
      toggleAll.textContent = isCollapsing ? 'Expand All' : 'Collapse All';
    });

    document.getElementById('resourceSearch').addEventListener('input', function () {
      const keyword = this.value.trim();
      renderResources(window._resourceData || fallbackResources, keyword);
    });

    fetch("https://script.google.com/macros/s/AKfycbwTTAuxRfchBrjPU-QGkOA-ichOtfxYriB0H4QVwVb3xgRfk_bjl8a6rZDT-8ysZJQ6Jw/exec?sheet=resources")
      .then(response => response.json())
      .then(data => {
        window._resourceData = data;
        renderResources(data);
      })
      .catch(error => {
        console.error("Failed to fetch resources, using fallback.", error);
        renderResources(fallbackResources);
      });

    // Obfuscate feedback email to reduce spam harvesting
    document.addEventListener("DOMContentLoaded", function () {
      const user = "feedback";
      const domain = "diwyfp.com";
      const email = `${user}@${domain}`;
      const link = document.getElementById("emailLink");
      if (link) {
        link.textContent = email;
        link.href = `mailto:${email}`;
      }
    });
  </script>
</body>
</html>

